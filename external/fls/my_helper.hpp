#include <cstdint>
#include <fstream>
#include <iostream>
#include <string>
#include <vector>
namespace helper {
template <typename T>
static std::vector<T> load_data_binary(const std::string& filename, bool print = true) {
  std::vector<T> data;

  std::ifstream in(filename, std::ios::binary);
  if (!in.is_open()) {
    std::cerr << "unable to open " << filename << std::endl;
    exit(EXIT_FAILURE);
  }
  // Read size.
  uint64_t size;
  in.read(reinterpret_cast<char*>(&size), sizeof(uint64_t));
  data.resize(size);
  // Read values.
  in.read(reinterpret_cast<char*>(data.data()), size * sizeof(T));
  in.close();

  return data;
}

template <typename T>
static std::vector<T> load_data(const std::string& filename) {
  std::vector<T> data;
  std::ifstream src_file(filename, std::ios::in);
  if (!src_file) {
    std::cout << "error opening source file." << std::endl;
    exit(1);
  }

  while (src_file.good()) {
    T next;
    src_file >> next;
    if (!src_file.good()) {
      break;
    }
    data.emplace_back(next);
  }
  src_file.close();

  return data;
}

static inline int CountLeadingZeros(uint64_t value) {
#if defined(__clang__) || defined(__GNUC__)
  if (value == 0) {
    return 64;
  }
  return static_cast<int>(__builtin_clzll(value));
#elif defined(_MSC_VER)
  unsigned long index;                     // NOLINT
  if (_BitScanReverse64(&index, value)) {  // NOLINT
    return 63 - static_cast<int>(index);
  } else {
    return 64;
  }
#else
  int bitpos = 0;
  while (value != 0) {
    value >>= 1;
    ++bitpos;
  }
  return 64 - bitpos;
#endif
}

// Returns the minimum number of bits needed to represent an unsigned value
static inline int NumRequiredBits(uint64_t x) { return 64 - CountLeadingZeros(x); }

// Returns ceil(log2(x)).
static inline int Log2(uint64_t x) {
  // DCHECK_GT(x, 0);
  return NumRequiredBits(x - 1);
}

constexpr size_t K_VECTOR_SIZE = 1024;
constexpr size_t TILE_START_POS[8] = {0, 16 * 4, 16 * 2, 16 * 6, 16 * 1, 16 * 5, 16 * 3, 16 * 7};
static inline void fls_transpose(const uint32_t* __restrict in, uint32_t* __restrict out) {
  // 8 values at a time.
  for (size_t i = 0; i < K_VECTOR_SIZE; i += 8) {
    auto tile_num = i % 64 / 8;
    auto start_pos_in_tile = i / 64;
    for (int j = 0; j < 8; ++j) {
      out[TILE_START_POS[tile_num] + start_pos_in_tile + j * 128] = in[i + j];
    }
  }
  // for (size_t i = 0; i < K_VECTOR_SIZE; ++i) {
  //   assert(out[i] == helper::transposed_arr_ow32[i]);
  // }
}

static inline void fls_untranspose_generated(const uint32_t* __restrict in, uint32_t* __restrict out) {
  out[0] = in[0];
  out[1] = in[128];
  out[2] = in[256];
  out[3] = in[384];
  out[4] = in[512];
  out[5] = in[640];
  out[6] = in[768];
  out[7] = in[896];
  out[8] = in[64];
  out[9] = in[192];
  out[10] = in[320];
  out[11] = in[448];
  out[12] = in[576];
  out[13] = in[704];
  out[14] = in[832];
  out[15] = in[960];
  out[16] = in[32];
  out[17] = in[160];
  out[18] = in[288];
  out[19] = in[416];
  out[20] = in[544];
  out[21] = in[672];
  out[22] = in[800];
  out[23] = in[928];
  out[24] = in[96];
  out[25] = in[224];
  out[26] = in[352];
  out[27] = in[480];
  out[28] = in[608];
  out[29] = in[736];
  out[30] = in[864];
  out[31] = in[992];
  out[32] = in[16];
  out[33] = in[144];
  out[34] = in[272];
  out[35] = in[400];
  out[36] = in[528];
  out[37] = in[656];
  out[38] = in[784];
  out[39] = in[912];
  out[40] = in[80];
  out[41] = in[208];
  out[42] = in[336];
  out[43] = in[464];
  out[44] = in[592];
  out[45] = in[720];
  out[46] = in[848];
  out[47] = in[976];
  out[48] = in[48];
  out[49] = in[176];
  out[50] = in[304];
  out[51] = in[432];
  out[52] = in[560];
  out[53] = in[688];
  out[54] = in[816];
  out[55] = in[944];
  out[56] = in[112];
  out[57] = in[240];
  out[58] = in[368];
  out[59] = in[496];
  out[60] = in[624];
  out[61] = in[752];
  out[62] = in[880];
  out[63] = in[1008];
  out[64] = in[1];
  out[65] = in[129];
  out[66] = in[257];
  out[67] = in[385];
  out[68] = in[513];
  out[69] = in[641];
  out[70] = in[769];
  out[71] = in[897];
  out[72] = in[65];
  out[73] = in[193];
  out[74] = in[321];
  out[75] = in[449];
  out[76] = in[577];
  out[77] = in[705];
  out[78] = in[833];
  out[79] = in[961];
  out[80] = in[33];
  out[81] = in[161];
  out[82] = in[289];
  out[83] = in[417];
  out[84] = in[545];
  out[85] = in[673];
  out[86] = in[801];
  out[87] = in[929];
  out[88] = in[97];
  out[89] = in[225];
  out[90] = in[353];
  out[91] = in[481];
  out[92] = in[609];
  out[93] = in[737];
  out[94] = in[865];
  out[95] = in[993];
  out[96] = in[17];
  out[97] = in[145];
  out[98] = in[273];
  out[99] = in[401];
  out[100] = in[529];
  out[101] = in[657];
  out[102] = in[785];
  out[103] = in[913];
  out[104] = in[81];
  out[105] = in[209];
  out[106] = in[337];
  out[107] = in[465];
  out[108] = in[593];
  out[109] = in[721];
  out[110] = in[849];
  out[111] = in[977];
  out[112] = in[49];
  out[113] = in[177];
  out[114] = in[305];
  out[115] = in[433];
  out[116] = in[561];
  out[117] = in[689];
  out[118] = in[817];
  out[119] = in[945];
  out[120] = in[113];
  out[121] = in[241];
  out[122] = in[369];
  out[123] = in[497];
  out[124] = in[625];
  out[125] = in[753];
  out[126] = in[881];
  out[127] = in[1009];
  out[128] = in[2];
  out[129] = in[130];
  out[130] = in[258];
  out[131] = in[386];
  out[132] = in[514];
  out[133] = in[642];
  out[134] = in[770];
  out[135] = in[898];
  out[136] = in[66];
  out[137] = in[194];
  out[138] = in[322];
  out[139] = in[450];
  out[140] = in[578];
  out[141] = in[706];
  out[142] = in[834];
  out[143] = in[962];
  out[144] = in[34];
  out[145] = in[162];
  out[146] = in[290];
  out[147] = in[418];
  out[148] = in[546];
  out[149] = in[674];
  out[150] = in[802];
  out[151] = in[930];
  out[152] = in[98];
  out[153] = in[226];
  out[154] = in[354];
  out[155] = in[482];
  out[156] = in[610];
  out[157] = in[738];
  out[158] = in[866];
  out[159] = in[994];
  out[160] = in[18];
  out[161] = in[146];
  out[162] = in[274];
  out[163] = in[402];
  out[164] = in[530];
  out[165] = in[658];
  out[166] = in[786];
  out[167] = in[914];
  out[168] = in[82];
  out[169] = in[210];
  out[170] = in[338];
  out[171] = in[466];
  out[172] = in[594];
  out[173] = in[722];
  out[174] = in[850];
  out[175] = in[978];
  out[176] = in[50];
  out[177] = in[178];
  out[178] = in[306];
  out[179] = in[434];
  out[180] = in[562];
  out[181] = in[690];
  out[182] = in[818];
  out[183] = in[946];
  out[184] = in[114];
  out[185] = in[242];
  out[186] = in[370];
  out[187] = in[498];
  out[188] = in[626];
  out[189] = in[754];
  out[190] = in[882];
  out[191] = in[1010];
  out[192] = in[3];
  out[193] = in[131];
  out[194] = in[259];
  out[195] = in[387];
  out[196] = in[515];
  out[197] = in[643];
  out[198] = in[771];
  out[199] = in[899];
  out[200] = in[67];
  out[201] = in[195];
  out[202] = in[323];
  out[203] = in[451];
  out[204] = in[579];
  out[205] = in[707];
  out[206] = in[835];
  out[207] = in[963];
  out[208] = in[35];
  out[209] = in[163];
  out[210] = in[291];
  out[211] = in[419];
  out[212] = in[547];
  out[213] = in[675];
  out[214] = in[803];
  out[215] = in[931];
  out[216] = in[99];
  out[217] = in[227];
  out[218] = in[355];
  out[219] = in[483];
  out[220] = in[611];
  out[221] = in[739];
  out[222] = in[867];
  out[223] = in[995];
  out[224] = in[19];
  out[225] = in[147];
  out[226] = in[275];
  out[227] = in[403];
  out[228] = in[531];
  out[229] = in[659];
  out[230] = in[787];
  out[231] = in[915];
  out[232] = in[83];
  out[233] = in[211];
  out[234] = in[339];
  out[235] = in[467];
  out[236] = in[595];
  out[237] = in[723];
  out[238] = in[851];
  out[239] = in[979];
  out[240] = in[51];
  out[241] = in[179];
  out[242] = in[307];
  out[243] = in[435];
  out[244] = in[563];
  out[245] = in[691];
  out[246] = in[819];
  out[247] = in[947];
  out[248] = in[115];
  out[249] = in[243];
  out[250] = in[371];
  out[251] = in[499];
  out[252] = in[627];
  out[253] = in[755];
  out[254] = in[883];
  out[255] = in[1011];
  out[256] = in[4];
  out[257] = in[132];
  out[258] = in[260];
  out[259] = in[388];
  out[260] = in[516];
  out[261] = in[644];
  out[262] = in[772];
  out[263] = in[900];
  out[264] = in[68];
  out[265] = in[196];
  out[266] = in[324];
  out[267] = in[452];
  out[268] = in[580];
  out[269] = in[708];
  out[270] = in[836];
  out[271] = in[964];
  out[272] = in[36];
  out[273] = in[164];
  out[274] = in[292];
  out[275] = in[420];
  out[276] = in[548];
  out[277] = in[676];
  out[278] = in[804];
  out[279] = in[932];
  out[280] = in[100];
  out[281] = in[228];
  out[282] = in[356];
  out[283] = in[484];
  out[284] = in[612];
  out[285] = in[740];
  out[286] = in[868];
  out[287] = in[996];
  out[288] = in[20];
  out[289] = in[148];
  out[290] = in[276];
  out[291] = in[404];
  out[292] = in[532];
  out[293] = in[660];
  out[294] = in[788];
  out[295] = in[916];
  out[296] = in[84];
  out[297] = in[212];
  out[298] = in[340];
  out[299] = in[468];
  out[300] = in[596];
  out[301] = in[724];
  out[302] = in[852];
  out[303] = in[980];
  out[304] = in[52];
  out[305] = in[180];
  out[306] = in[308];
  out[307] = in[436];
  out[308] = in[564];
  out[309] = in[692];
  out[310] = in[820];
  out[311] = in[948];
  out[312] = in[116];
  out[313] = in[244];
  out[314] = in[372];
  out[315] = in[500];
  out[316] = in[628];
  out[317] = in[756];
  out[318] = in[884];
  out[319] = in[1012];
  out[320] = in[5];
  out[321] = in[133];
  out[322] = in[261];
  out[323] = in[389];
  out[324] = in[517];
  out[325] = in[645];
  out[326] = in[773];
  out[327] = in[901];
  out[328] = in[69];
  out[329] = in[197];
  out[330] = in[325];
  out[331] = in[453];
  out[332] = in[581];
  out[333] = in[709];
  out[334] = in[837];
  out[335] = in[965];
  out[336] = in[37];
  out[337] = in[165];
  out[338] = in[293];
  out[339] = in[421];
  out[340] = in[549];
  out[341] = in[677];
  out[342] = in[805];
  out[343] = in[933];
  out[344] = in[101];
  out[345] = in[229];
  out[346] = in[357];
  out[347] = in[485];
  out[348] = in[613];
  out[349] = in[741];
  out[350] = in[869];
  out[351] = in[997];
  out[352] = in[21];
  out[353] = in[149];
  out[354] = in[277];
  out[355] = in[405];
  out[356] = in[533];
  out[357] = in[661];
  out[358] = in[789];
  out[359] = in[917];
  out[360] = in[85];
  out[361] = in[213];
  out[362] = in[341];
  out[363] = in[469];
  out[364] = in[597];
  out[365] = in[725];
  out[366] = in[853];
  out[367] = in[981];
  out[368] = in[53];
  out[369] = in[181];
  out[370] = in[309];
  out[371] = in[437];
  out[372] = in[565];
  out[373] = in[693];
  out[374] = in[821];
  out[375] = in[949];
  out[376] = in[117];
  out[377] = in[245];
  out[378] = in[373];
  out[379] = in[501];
  out[380] = in[629];
  out[381] = in[757];
  out[382] = in[885];
  out[383] = in[1013];
  out[384] = in[6];
  out[385] = in[134];
  out[386] = in[262];
  out[387] = in[390];
  out[388] = in[518];
  out[389] = in[646];
  out[390] = in[774];
  out[391] = in[902];
  out[392] = in[70];
  out[393] = in[198];
  out[394] = in[326];
  out[395] = in[454];
  out[396] = in[582];
  out[397] = in[710];
  out[398] = in[838];
  out[399] = in[966];
  out[400] = in[38];
  out[401] = in[166];
  out[402] = in[294];
  out[403] = in[422];
  out[404] = in[550];
  out[405] = in[678];
  out[406] = in[806];
  out[407] = in[934];
  out[408] = in[102];
  out[409] = in[230];
  out[410] = in[358];
  out[411] = in[486];
  out[412] = in[614];
  out[413] = in[742];
  out[414] = in[870];
  out[415] = in[998];
  out[416] = in[22];
  out[417] = in[150];
  out[418] = in[278];
  out[419] = in[406];
  out[420] = in[534];
  out[421] = in[662];
  out[422] = in[790];
  out[423] = in[918];
  out[424] = in[86];
  out[425] = in[214];
  out[426] = in[342];
  out[427] = in[470];
  out[428] = in[598];
  out[429] = in[726];
  out[430] = in[854];
  out[431] = in[982];
  out[432] = in[54];
  out[433] = in[182];
  out[434] = in[310];
  out[435] = in[438];
  out[436] = in[566];
  out[437] = in[694];
  out[438] = in[822];
  out[439] = in[950];
  out[440] = in[118];
  out[441] = in[246];
  out[442] = in[374];
  out[443] = in[502];
  out[444] = in[630];
  out[445] = in[758];
  out[446] = in[886];
  out[447] = in[1014];
  out[448] = in[7];
  out[449] = in[135];
  out[450] = in[263];
  out[451] = in[391];
  out[452] = in[519];
  out[453] = in[647];
  out[454] = in[775];
  out[455] = in[903];
  out[456] = in[71];
  out[457] = in[199];
  out[458] = in[327];
  out[459] = in[455];
  out[460] = in[583];
  out[461] = in[711];
  out[462] = in[839];
  out[463] = in[967];
  out[464] = in[39];
  out[465] = in[167];
  out[466] = in[295];
  out[467] = in[423];
  out[468] = in[551];
  out[469] = in[679];
  out[470] = in[807];
  out[471] = in[935];
  out[472] = in[103];
  out[473] = in[231];
  out[474] = in[359];
  out[475] = in[487];
  out[476] = in[615];
  out[477] = in[743];
  out[478] = in[871];
  out[479] = in[999];
  out[480] = in[23];
  out[481] = in[151];
  out[482] = in[279];
  out[483] = in[407];
  out[484] = in[535];
  out[485] = in[663];
  out[486] = in[791];
  out[487] = in[919];
  out[488] = in[87];
  out[489] = in[215];
  out[490] = in[343];
  out[491] = in[471];
  out[492] = in[599];
  out[493] = in[727];
  out[494] = in[855];
  out[495] = in[983];
  out[496] = in[55];
  out[497] = in[183];
  out[498] = in[311];
  out[499] = in[439];
  out[500] = in[567];
  out[501] = in[695];
  out[502] = in[823];
  out[503] = in[951];
  out[504] = in[119];
  out[505] = in[247];
  out[506] = in[375];
  out[507] = in[503];
  out[508] = in[631];
  out[509] = in[759];
  out[510] = in[887];
  out[511] = in[1015];
  out[512] = in[8];
  out[513] = in[136];
  out[514] = in[264];
  out[515] = in[392];
  out[516] = in[520];
  out[517] = in[648];
  out[518] = in[776];
  out[519] = in[904];
  out[520] = in[72];
  out[521] = in[200];
  out[522] = in[328];
  out[523] = in[456];
  out[524] = in[584];
  out[525] = in[712];
  out[526] = in[840];
  out[527] = in[968];
  out[528] = in[40];
  out[529] = in[168];
  out[530] = in[296];
  out[531] = in[424];
  out[532] = in[552];
  out[533] = in[680];
  out[534] = in[808];
  out[535] = in[936];
  out[536] = in[104];
  out[537] = in[232];
  out[538] = in[360];
  out[539] = in[488];
  out[540] = in[616];
  out[541] = in[744];
  out[542] = in[872];
  out[543] = in[1000];
  out[544] = in[24];
  out[545] = in[152];
  out[546] = in[280];
  out[547] = in[408];
  out[548] = in[536];
  out[549] = in[664];
  out[550] = in[792];
  out[551] = in[920];
  out[552] = in[88];
  out[553] = in[216];
  out[554] = in[344];
  out[555] = in[472];
  out[556] = in[600];
  out[557] = in[728];
  out[558] = in[856];
  out[559] = in[984];
  out[560] = in[56];
  out[561] = in[184];
  out[562] = in[312];
  out[563] = in[440];
  out[564] = in[568];
  out[565] = in[696];
  out[566] = in[824];
  out[567] = in[952];
  out[568] = in[120];
  out[569] = in[248];
  out[570] = in[376];
  out[571] = in[504];
  out[572] = in[632];
  out[573] = in[760];
  out[574] = in[888];
  out[575] = in[1016];
  out[576] = in[9];
  out[577] = in[137];
  out[578] = in[265];
  out[579] = in[393];
  out[580] = in[521];
  out[581] = in[649];
  out[582] = in[777];
  out[583] = in[905];
  out[584] = in[73];
  out[585] = in[201];
  out[586] = in[329];
  out[587] = in[457];
  out[588] = in[585];
  out[589] = in[713];
  out[590] = in[841];
  out[591] = in[969];
  out[592] = in[41];
  out[593] = in[169];
  out[594] = in[297];
  out[595] = in[425];
  out[596] = in[553];
  out[597] = in[681];
  out[598] = in[809];
  out[599] = in[937];
  out[600] = in[105];
  out[601] = in[233];
  out[602] = in[361];
  out[603] = in[489];
  out[604] = in[617];
  out[605] = in[745];
  out[606] = in[873];
  out[607] = in[1001];
  out[608] = in[25];
  out[609] = in[153];
  out[610] = in[281];
  out[611] = in[409];
  out[612] = in[537];
  out[613] = in[665];
  out[614] = in[793];
  out[615] = in[921];
  out[616] = in[89];
  out[617] = in[217];
  out[618] = in[345];
  out[619] = in[473];
  out[620] = in[601];
  out[621] = in[729];
  out[622] = in[857];
  out[623] = in[985];
  out[624] = in[57];
  out[625] = in[185];
  out[626] = in[313];
  out[627] = in[441];
  out[628] = in[569];
  out[629] = in[697];
  out[630] = in[825];
  out[631] = in[953];
  out[632] = in[121];
  out[633] = in[249];
  out[634] = in[377];
  out[635] = in[505];
  out[636] = in[633];
  out[637] = in[761];
  out[638] = in[889];
  out[639] = in[1017];
  out[640] = in[10];
  out[641] = in[138];
  out[642] = in[266];
  out[643] = in[394];
  out[644] = in[522];
  out[645] = in[650];
  out[646] = in[778];
  out[647] = in[906];
  out[648] = in[74];
  out[649] = in[202];
  out[650] = in[330];
  out[651] = in[458];
  out[652] = in[586];
  out[653] = in[714];
  out[654] = in[842];
  out[655] = in[970];
  out[656] = in[42];
  out[657] = in[170];
  out[658] = in[298];
  out[659] = in[426];
  out[660] = in[554];
  out[661] = in[682];
  out[662] = in[810];
  out[663] = in[938];
  out[664] = in[106];
  out[665] = in[234];
  out[666] = in[362];
  out[667] = in[490];
  out[668] = in[618];
  out[669] = in[746];
  out[670] = in[874];
  out[671] = in[1002];
  out[672] = in[26];
  out[673] = in[154];
  out[674] = in[282];
  out[675] = in[410];
  out[676] = in[538];
  out[677] = in[666];
  out[678] = in[794];
  out[679] = in[922];
  out[680] = in[90];
  out[681] = in[218];
  out[682] = in[346];
  out[683] = in[474];
  out[684] = in[602];
  out[685] = in[730];
  out[686] = in[858];
  out[687] = in[986];
  out[688] = in[58];
  out[689] = in[186];
  out[690] = in[314];
  out[691] = in[442];
  out[692] = in[570];
  out[693] = in[698];
  out[694] = in[826];
  out[695] = in[954];
  out[696] = in[122];
  out[697] = in[250];
  out[698] = in[378];
  out[699] = in[506];
  out[700] = in[634];
  out[701] = in[762];
  out[702] = in[890];
  out[703] = in[1018];
  out[704] = in[11];
  out[705] = in[139];
  out[706] = in[267];
  out[707] = in[395];
  out[708] = in[523];
  out[709] = in[651];
  out[710] = in[779];
  out[711] = in[907];
  out[712] = in[75];
  out[713] = in[203];
  out[714] = in[331];
  out[715] = in[459];
  out[716] = in[587];
  out[717] = in[715];
  out[718] = in[843];
  out[719] = in[971];
  out[720] = in[43];
  out[721] = in[171];
  out[722] = in[299];
  out[723] = in[427];
  out[724] = in[555];
  out[725] = in[683];
  out[726] = in[811];
  out[727] = in[939];
  out[728] = in[107];
  out[729] = in[235];
  out[730] = in[363];
  out[731] = in[491];
  out[732] = in[619];
  out[733] = in[747];
  out[734] = in[875];
  out[735] = in[1003];
  out[736] = in[27];
  out[737] = in[155];
  out[738] = in[283];
  out[739] = in[411];
  out[740] = in[539];
  out[741] = in[667];
  out[742] = in[795];
  out[743] = in[923];
  out[744] = in[91];
  out[745] = in[219];
  out[746] = in[347];
  out[747] = in[475];
  out[748] = in[603];
  out[749] = in[731];
  out[750] = in[859];
  out[751] = in[987];
  out[752] = in[59];
  out[753] = in[187];
  out[754] = in[315];
  out[755] = in[443];
  out[756] = in[571];
  out[757] = in[699];
  out[758] = in[827];
  out[759] = in[955];
  out[760] = in[123];
  out[761] = in[251];
  out[762] = in[379];
  out[763] = in[507];
  out[764] = in[635];
  out[765] = in[763];
  out[766] = in[891];
  out[767] = in[1019];
  out[768] = in[12];
  out[769] = in[140];
  out[770] = in[268];
  out[771] = in[396];
  out[772] = in[524];
  out[773] = in[652];
  out[774] = in[780];
  out[775] = in[908];
  out[776] = in[76];
  out[777] = in[204];
  out[778] = in[332];
  out[779] = in[460];
  out[780] = in[588];
  out[781] = in[716];
  out[782] = in[844];
  out[783] = in[972];
  out[784] = in[44];
  out[785] = in[172];
  out[786] = in[300];
  out[787] = in[428];
  out[788] = in[556];
  out[789] = in[684];
  out[790] = in[812];
  out[791] = in[940];
  out[792] = in[108];
  out[793] = in[236];
  out[794] = in[364];
  out[795] = in[492];
  out[796] = in[620];
  out[797] = in[748];
  out[798] = in[876];
  out[799] = in[1004];
  out[800] = in[28];
  out[801] = in[156];
  out[802] = in[284];
  out[803] = in[412];
  out[804] = in[540];
  out[805] = in[668];
  out[806] = in[796];
  out[807] = in[924];
  out[808] = in[92];
  out[809] = in[220];
  out[810] = in[348];
  out[811] = in[476];
  out[812] = in[604];
  out[813] = in[732];
  out[814] = in[860];
  out[815] = in[988];
  out[816] = in[60];
  out[817] = in[188];
  out[818] = in[316];
  out[819] = in[444];
  out[820] = in[572];
  out[821] = in[700];
  out[822] = in[828];
  out[823] = in[956];
  out[824] = in[124];
  out[825] = in[252];
  out[826] = in[380];
  out[827] = in[508];
  out[828] = in[636];
  out[829] = in[764];
  out[830] = in[892];
  out[831] = in[1020];
  out[832] = in[13];
  out[833] = in[141];
  out[834] = in[269];
  out[835] = in[397];
  out[836] = in[525];
  out[837] = in[653];
  out[838] = in[781];
  out[839] = in[909];
  out[840] = in[77];
  out[841] = in[205];
  out[842] = in[333];
  out[843] = in[461];
  out[844] = in[589];
  out[845] = in[717];
  out[846] = in[845];
  out[847] = in[973];
  out[848] = in[45];
  out[849] = in[173];
  out[850] = in[301];
  out[851] = in[429];
  out[852] = in[557];
  out[853] = in[685];
  out[854] = in[813];
  out[855] = in[941];
  out[856] = in[109];
  out[857] = in[237];
  out[858] = in[365];
  out[859] = in[493];
  out[860] = in[621];
  out[861] = in[749];
  out[862] = in[877];
  out[863] = in[1005];
  out[864] = in[29];
  out[865] = in[157];
  out[866] = in[285];
  out[867] = in[413];
  out[868] = in[541];
  out[869] = in[669];
  out[870] = in[797];
  out[871] = in[925];
  out[872] = in[93];
  out[873] = in[221];
  out[874] = in[349];
  out[875] = in[477];
  out[876] = in[605];
  out[877] = in[733];
  out[878] = in[861];
  out[879] = in[989];
  out[880] = in[61];
  out[881] = in[189];
  out[882] = in[317];
  out[883] = in[445];
  out[884] = in[573];
  out[885] = in[701];
  out[886] = in[829];
  out[887] = in[957];
  out[888] = in[125];
  out[889] = in[253];
  out[890] = in[381];
  out[891] = in[509];
  out[892] = in[637];
  out[893] = in[765];
  out[894] = in[893];
  out[895] = in[1021];
  out[896] = in[14];
  out[897] = in[142];
  out[898] = in[270];
  out[899] = in[398];
  out[900] = in[526];
  out[901] = in[654];
  out[902] = in[782];
  out[903] = in[910];
  out[904] = in[78];
  out[905] = in[206];
  out[906] = in[334];
  out[907] = in[462];
  out[908] = in[590];
  out[909] = in[718];
  out[910] = in[846];
  out[911] = in[974];
  out[912] = in[46];
  out[913] = in[174];
  out[914] = in[302];
  out[915] = in[430];
  out[916] = in[558];
  out[917] = in[686];
  out[918] = in[814];
  out[919] = in[942];
  out[920] = in[110];
  out[921] = in[238];
  out[922] = in[366];
  out[923] = in[494];
  out[924] = in[622];
  out[925] = in[750];
  out[926] = in[878];
  out[927] = in[1006];
  out[928] = in[30];
  out[929] = in[158];
  out[930] = in[286];
  out[931] = in[414];
  out[932] = in[542];
  out[933] = in[670];
  out[934] = in[798];
  out[935] = in[926];
  out[936] = in[94];
  out[937] = in[222];
  out[938] = in[350];
  out[939] = in[478];
  out[940] = in[606];
  out[941] = in[734];
  out[942] = in[862];
  out[943] = in[990];
  out[944] = in[62];
  out[945] = in[190];
  out[946] = in[318];
  out[947] = in[446];
  out[948] = in[574];
  out[949] = in[702];
  out[950] = in[830];
  out[951] = in[958];
  out[952] = in[126];
  out[953] = in[254];
  out[954] = in[382];
  out[955] = in[510];
  out[956] = in[638];
  out[957] = in[766];
  out[958] = in[894];
  out[959] = in[1022];
  out[960] = in[15];
  out[961] = in[143];
  out[962] = in[271];
  out[963] = in[399];
  out[964] = in[527];
  out[965] = in[655];
  out[966] = in[783];
  out[967] = in[911];
  out[968] = in[79];
  out[969] = in[207];
  out[970] = in[335];
  out[971] = in[463];
  out[972] = in[591];
  out[973] = in[719];
  out[974] = in[847];
  out[975] = in[975];
  out[976] = in[47];
  out[977] = in[175];
  out[978] = in[303];
  out[979] = in[431];
  out[980] = in[559];
  out[981] = in[687];
  out[982] = in[815];
  out[983] = in[943];
  out[984] = in[111];
  out[985] = in[239];
  out[986] = in[367];
  out[987] = in[495];
  out[988] = in[623];
  out[989] = in[751];
  out[990] = in[879];
  out[991] = in[1007];
  out[992] = in[31];
  out[993] = in[159];
  out[994] = in[287];
  out[995] = in[415];
  out[996] = in[543];
  out[997] = in[671];
  out[998] = in[799];
  out[999] = in[927];
  out[1000] = in[95];
  out[1001] = in[223];
  out[1002] = in[351];
  out[1003] = in[479];
  out[1004] = in[607];
  out[1005] = in[735];
  out[1006] = in[863];
  out[1007] = in[991];
  out[1008] = in[63];
  out[1009] = in[191];
  out[1010] = in[319];
  out[1011] = in[447];
  out[1012] = in[575];
  out[1013] = in[703];
  out[1014] = in[831];
  out[1015] = in[959];
  out[1016] = in[127];
  out[1017] = in[255];
  out[1018] = in[383];
  out[1019] = in[511];
  out[1020] = in[639];
  out[1021] = in[767];
  out[1022] = in[895];
  out[1023] = in[1023];
}

static inline void fls_untranspose(const uint32_t* __restrict in, uint32_t* __restrict out) {
  // 8 values at a time.
  for (size_t i = 0; i < K_VECTOR_SIZE; i += 8) {
    auto tile_num = i % 64 / 8;
    auto start_pos_in_tile = i / 64;
    for (int j = 0; j < 8; ++j) {
      out[i + j] = in[TILE_START_POS[tile_num] + start_pos_in_tile + j * 128];
    }
  }
  // for (size_t i = 0; i < K_VECTOR_SIZE; ++i) {
  //   assert(out[i] == helper::transposed_arr_ow32[i]);
  // }
}

// return max bit width
static inline uint8_t fls_delta(const uint32_t* in, uint32_t* out, uint32_t* base) {
  uint32_t cur[32] = {0};
  // 32 bits: tile 0 and tile 4, total 32 values
  for (size_t i = 0; i < 32; ++i) {
    base[i] = in[i];
    cur[i] = in[i];
  }
  uint32_t max_delta = 0;
  constexpr size_t tile_starts[4] = {0, 64, 32, 96};
  for (auto t : tile_starts) {
    // 8 1024-bit vector adds
    for (size_t i = 0; i < 8; ++i) {
      for (size_t j = 0; j < 32; ++j) {
        auto delta = in[t + i * 128 + j] - cur[j];
        out[t + i * 128 + j] = delta;
        cur[j] = in[t + i * 128 + j];
        if (delta > max_delta) {
          max_delta = delta;
        }
      }
    }
  }
  return helper::NumRequiredBits(max_delta);
}
}  // namespace helper